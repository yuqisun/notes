<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>diting</title>
    <link rel="stylesheet" href="../app/css/stock.scroller.css">

    <script src="anychart/js/anychart-base.min.js"></script>
    <script src="anychart/js/anychart-stock.min.js"></script>
    <script src="anychart/js/anychart-exports.min.js"></script>
    <script src="anychart/js/anychart-ui.min.js"></script>
    <script src="jquery/jquery-3.3.1.min.js"></script>

    <!--<script src="angularjs/angular.min.js">-->
</head>

<body>
    <div>
        <form>
            App Name: <input type="text" name="appname" id="appname">
            <select id="precisions">
                <option value="5">5</option>
                <option value="60">60</option>
                <option value="300">300</option>
                <option value="1800">1800</option>
                <option value="3600">3600</option>
                <option value="18000">18000</option>
                <option value="86400">86400</option>
            </select>
            <input type="submit" value="Submit">
        </form>
    </div>

    <div id="container"></div>
    <script src="app/js/stock.scroller.js"></script>

</body>
</html>




----------------------------------


$('form').submit(function(e) {
    e.preventDefault();

    var appname = document.getElementById("appname").value;
    var e = document.getElementById("precisions");
    var prec = e.options[e.selectedIndex].value;

    console.log('app name: ' + appname + ', precision: ' + prec);

    document.getElementById("container").innerHTML = '';
    anychart.onDocumentReady(function () {
        // create data table on loaded data
        var dataTable = anychart.data.table('x');
        dataTable.addData(getData(appname, prec));

        // map loaded data
        var mapping = dataTable.mapAs({x: 'x', value: 'value'});

        // create stock chart
        var chart = anychart.stock();

        // add a series
        chart.plot(0).line(mapping);

        // create scroller series with mapped data
        chart.scroller().column(mapping);

        // adjust the title
        chart.title("hits details [prec is " + prec + "]");

        // set container id for the chart
        chart.container('container');

        // initiate chart drawing
        chart.draw();
    });

    function getData(appName, spec){
        var data = new Array();;
        $.ajax({
            async: false,
            cache: false,
            url: '/getCounter/'+appName+'/'+spec,
            dataType: 'text',
            success: function(resp) {
                var result = JSON.parse(resp);
                for(var index=0; index<result.length; index++) {
                    var tmp = new Object();
                    var xValue = result[index].x.split('.');
                    tmp.x = Date.UTC(xValue[0], xValue[1]-1, xValue[2], xValue[3], xValue[4], xValue[5]);
                    tmp.value = result[index].value;
                    data[index] = tmp;
                }
            }

        });
        //data = [{'x':'05.04.2010 17:31:50', 'value':7},{'x':'05.04.2010 17:30:05', 'value':2}];
        //data = [{"x":Date.UTC(2018, 00, 11, 04, 41, 00), "value":7},{"x":Date.UTC(2018, 00, 11, 04, 41, 30), "value":2},{"x":Date.UTC(2018, 00, 11, 04, 42, 00), "value":5}];
        console.log(data);
        return data;
    }

});



