Redis 持久化数据到硬盘：
1. 快照(snapshotting)
2. 只追加文件(append-only file, AOF)

快照持久化只适用于那些即使丢失一部分数据也不会造成问题的应用程序，而不能接受这种数据损失的应用程序则可以考录使用 AOF持久化。

WATCH:  
在用户使用WATCH命令对键进行监视之后，直到用户执行 EXEC 命令的这段时间里面，如果有其他客户端抢先对任何
被监视的键进行了替换、更新或删除等操作，那么当用户尝试执行 EXEC 命令的时候，事务将失败并返回一个错误（之后用户可以选择重试事务或者放弃事务）。

关系型数据库：悲观锁  
Redis：乐观锁

关系型数据库在访问以写入为目的数据的时候，关系数据库会对被访问的数据进行加锁，直到事务被提交或者回滚。
如果有其他客户试图对被加锁的数据写入，将被阻塞。缺点在于：持有锁的客户端运行的越慢，等待锁的客户端被阻塞的时间越长。

Redis并不会在执行 WATCH 的时候对数据加锁，只会在数据被其他客户端前先修改的情况下通知执行了WATCH命令的客户端。
这样客户端永远不必花时间去等待取得锁的客户端，只需在自己的事务执行失败时进行重试就可以了。

> 我没觉得这有什么提高效率的啊，如果有一个客户端一直在写入，另一个WATCH的客户端不一样总是失败吗？  
> 所以乐观锁不是就一定好于悲观锁，需要看使用的场景。如果写比较少的情况下，即冲突真的很少发生的时候，这样可以省去了锁的开销，加大了系统的整个吞吐量。
但如果经常产生冲突，上层应用会不断的进行retry，这样反倒是降低了性能，所以这种情况下用悲观锁就比较合适。  
> *[一分钟教你知道乐观锁和悲观锁的区别](https://blog.csdn.net/hongchangfirst/article/details/26004335)*
